import{F as e,b as t,m as n,p as r}from"./chunks/plugin-vue_export-helper.Cyk5UgWo.js";const i=JSON.parse(`{"title":"浏览器 DNS 优化：rel=\\"dns-prefetch\\" 与 rel=\\"preconnect\\"","description":"","frontmatter":{},"headers":[],"relativePath":"浏览器/DNS优化.md","filePath":"浏览器/DNS优化.md","lastUpdated":1750817186000}`),a={name:`浏览器/DNS优化.md`};function o(t,i,a,o,s,c){return e(),n(`div`,null,i[0]||=[r(`<h1 id="浏览器-dns-优化-rel-dns-prefetch-与-rel-preconnect" tabindex="-1">浏览器 DNS 优化：<code>rel=&quot;dns-prefetch&quot;</code> 与 <code>rel=&quot;preconnect&quot;</code> <a class="header-anchor" href="#浏览器-dns-优化-rel-dns-prefetch-与-rel-preconnect" aria-label="Permalink to “浏览器 DNS 优化：rel=&quot;dns-prefetch&quot; 与 rel=&quot;preconnect&quot;”">​</a></h1><h2 id="_1-rel-dns-prefetch-dns-预解析" tabindex="-1">1. <strong><code>rel=&quot;dns-prefetch&quot;</code>（DNS 预解析）</strong> <a class="header-anchor" href="#_1-rel-dns-prefetch-dns-预解析" aria-label="Permalink to “1. rel=&quot;dns-prefetch&quot;（DNS 预解析）”">​</a></h2><ul><li><p><strong>原理</strong>：<br> 浏览器在后台提前解析指定域名的 DNS，将域名转换为 IP 地址。当后续实际请求该域名的资源时，直接使用已缓存的 IP，跳过 DNS 查询步骤（通常耗时 <strong>20-120ms</strong>）。</p></li><li><p><strong>使用方式</strong>（在 HTML 的 <code>&lt;head&gt;</code> 中添加）：</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">link</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dns-prefetch&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li><p><strong>适用场景</strong>：<br> 用于 <strong>非关键第三方资源</strong>（如广告、分析脚本、CDN 资源），提前解析 DNS 但无需立即建立连接。</p></li><li><p><strong>优势</strong>：</p><ul><li>资源消耗极低（仅解析 DNS）。</li><li>显著减少跨域资源的 DNS 延迟。</li><li>兼容性极佳（支持所有现代浏览器）。</li></ul></li></ul><h2 id="_2-rel-preconnect-预连接" tabindex="-1">2. <strong><code>rel=&quot;preconnect&quot;</code>（预连接）</strong> <a class="header-anchor" href="#_2-rel-preconnect-预连接" aria-label="Permalink to “2. rel=&quot;preconnect&quot;（预连接）”">​</a></h2><ul><li><p><strong>原理</strong>：<br> 浏览器提前完成与目标域名的 <strong>完整连接握手</strong>，包括：</p><ol><li><strong>DNS 解析</strong>（同 <code>dns-prefetch</code>）。</li><li><strong>TCP 握手</strong>（3 次往返）。</li><li><strong>TLS 协商</strong>（HTTPS 的额外 1-2 次往返）。<br> 后续请求可直接复用连接，跳过网络初始化延迟（通常节省 <strong>100-500ms</strong>）。</li></ol></li><li><p><strong>使用方式</strong>：</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">link</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;preconnect&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.example.com&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> crossorigin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><blockquote><p>注：<code>crossorigin</code> 属性用于跨域资源（如字体、CDN）。</p></blockquote></li><li><p><strong>适用场景</strong>：<br> 用于 <strong>关键跨域资源</strong>（如核心 CDN 库、API 域名、Web 字体），需立即建立连接。</p></li><li><p><strong>注意事项</strong>：</p><ul><li>占用额外资源（浏览器主动维护连接约 <strong>10-15 秒</strong>）。</li><li>过度使用可能导致带宽浪费（建议仅用于 3-4 个关键域名）。</li></ul></li></ul><h2 id="对比与最佳实践" tabindex="-1">对比与最佳实践 <a class="header-anchor" href="#对比与最佳实践" aria-label="Permalink to “对比与最佳实践”">​</a></h2><table tabindex="0"><thead><tr><th><strong>特性</strong></th><th><code>dns-prefetch</code></th><th><code>preconnect</code></th></tr></thead><tbody><tr><td><strong>优化范围</strong></td><td>仅 DNS 解析</td><td>DNS + TCP + TLS（完整连接）</td></tr><tr><td><strong>延迟节省</strong></td><td>20-120ms</td><td>100-500ms+</td></tr><tr><td><strong>资源消耗</strong></td><td>极低</td><td>中（维护 TCP/TLS 连接）</td></tr><tr><td><strong>推荐场景</strong></td><td>非关键第三方资源</td><td>关键渲染路径资源（CSS/JS/字体）</td></tr><tr><td><strong>兼容性</strong></td><td>IE10+、所有现代浏览器</td><td>IE 不支持，现代浏览器均支持</td></tr></tbody></table><h2 id="组合使用示例" tabindex="-1"><strong>组合使用示例</strong> <a class="header-anchor" href="#组合使用示例" aria-label="Permalink to “组合使用示例”">​</a></h2><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">head</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- 关键资源：预连接 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">link</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;preconnect&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://fonts.gstatic.com&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> crossorigin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- 非关键资源：仅 DNS 预解析 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">link</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dns-prefetch&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://analytics.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">link</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dns-prefetch&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://ads.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">head</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h4 id="最佳实践" tabindex="-1"><strong>最佳实践</strong> <a class="header-anchor" href="#最佳实践" aria-label="Permalink to “最佳实践”">​</a></h4><ol><li><strong>优先 <code>preconnect</code> 关键域名</strong>（如 CDN、主 API）。</li><li><strong>对次要资源用 <code>dns-prefetch</code></strong>（如分析工具、广告）。</li><li><strong>限制预连接数量</strong>（通常不超过 4 个），避免资源竞争。</li><li><strong>无需对同域资源使用</strong>（浏览器默认优化同域请求）。</li><li><strong>与 <code>preload</code> 结合</strong>（对已知 URL 的资源，用 <code>preload</code> 直接预加载内容）。</li></ol><h2 id="底层原理图解" tabindex="-1">底层原理图解 <a class="header-anchor" href="#底层原理图解" aria-label="Permalink to “底层原理图解”">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>普通请求流程：</span></span>
<span class="line"><span>  [DNS 查询] → [TCP 握手] → [TLS 协商] → 发送请求</span></span>
<span class="line"><span></span></span>
<span class="line"><span>dns-prefetch 优化：</span></span>
<span class="line"><span>  提前完成 [DNS 查询] ────────┐</span></span>
<span class="line"><span>                           ↓</span></span>
<span class="line"><span>  [TCP 握手] → [TLS 协商] → 发送请求</span></span>
<span class="line"><span></span></span>
<span class="line"><span>preconnect 优化：</span></span>
<span class="line"><span>  提前完成 [DNS 查询] → [TCP 握手] → [TLS 协商] ─┐</span></span>
<span class="line"><span>                                               ↓</span></span>
<span class="line"><span>                                            发送请求</span></span></code></pre></div><blockquote><p><strong>总结</strong>：</p><ul><li><code>dns-prefetch</code> 是轻量级 DNS 预热，适用于次要资源。</li><li><code>preconnect</code> 是完整连接预热，用于核心资源提速。<br> 合理使用可显著减少 RTT（Round Trip Time），提升页面加载性能。</li></ul></blockquote>`,14)])}var s=t(a,[[`render`,o]]);export{i as __pageData,s as default};