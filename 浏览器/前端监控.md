å‰ç«¯ç›‘æ§æ˜¯ç¡®ä¿åº”ç”¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒçš„å…³é”®ï¼Œä¸»è¦æ¶µç›–ä»¥ä¸‹æ ¸å¿ƒæŒ‡æ ‡ï¼Œé€šå¸¸åˆ†ä¸ºå‡ ä¸ªç»´åº¦ï¼š

---

### ä¸€ã€**æ€§èƒ½æŒ‡æ ‡ï¼ˆPerformanceï¼‰**
1. **é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP - First Contentful Paint)**
    - æµè§ˆå™¨é¦–æ¬¡æ¸²æŸ“**ä»»ä½•æ–‡æœ¬ã€å›¾ç‰‡æˆ–éç©ºç™½ Canvas/SVG** çš„æ—¶é—´ã€‚
    - **ç›®æ ‡**ï¼š< 1.8 ç§’ï¼ˆè‰¯å¥½ï¼‰
```js
const getFCP = () => {
  // 1. ä½¿ç”¨ PerformanceObserver ç›‘å¬ paint ç±»å‹æ¡ç›®
  const observer = new PerformanceObserver((list) => {
    for (const entry of list.getEntries()) {
      if (entry.name === 'first-contentful-paint') {
        // 2. è·å– FCP æ—¶é—´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
        const fcp = entry.startTime;
        console.log('FCP:', fcp);
        
        // 3. ä¸ŠæŠ¥æ•°æ®ï¼ˆç¤ºä¾‹ï¼‰
        sendToAnalytics({ metric: 'FCP', value: fcp });
        
        // 4. åœæ­¢ç›‘å¬
        observer.disconnect();
        break;
      }
    }
  });

  // 5. å¼€å§‹ç›‘å¬ paint ç±»å‹çš„æ€§èƒ½æ¡ç›®
  observer.observe({ type: 'paint', buffered: true });
};

// è°ƒç”¨å‡½æ•°å¼€å§‹é‡‡é›†
getFCP();
```

2. **æœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP - Largest Contentful Paint)**
    - è§†å£ä¸­**æœ€å¤§å¯è§å…ƒç´ **ï¼ˆå¦‚å›¾ç‰‡ã€æ ‡é¢˜æ–‡æœ¬å—ï¼‰çš„æ¸²æŸ“æ—¶é—´ã€‚
    - **ç›®æ ‡**ï¼š< 2.5 ç§’ï¼ˆè‰¯å¥½ï¼‰
```js
const getLCP = () => {
  let maxLcpValue = 0;
  const lcpEntries = [];

  // 1. åˆ›å»ºè§‚å¯Ÿè€…
  const observer = new PerformanceObserver((list) => {
    const entries = list.getEntries();
    entries.forEach(entry => {
      // 2. è®°å½•æ‰€æœ‰ LCP å€™é€‰å…ƒç´ 
      lcpEntries.push(entry);
      
      // 3. æ›´æ–°æœ€å¤§ LCP å€¼ï¼ˆå– renderTime æˆ– loadTimeï¼‰
      const time = entry.renderTime || entry.loadTime;
      if (time > maxLcpValue) {
        maxLcpValue = time;
      }
    });
  });

  // 4. å¼€å§‹ç›‘å¬ LCP æ¡ç›®
  observer.observe({ type: 'largest-contentful-paint', buffered: true });

  // 5. é¡µé¢åŠ è½½å®Œæˆæ—¶ç¡®å®šæœ€ç»ˆ LCP
  window.addEventListener('load', () => {
    // å»¶è¿Ÿç¡®ä¿æ•è·æ‰€æœ‰å…ƒç´ 
    setTimeout(() => {
      observer.disconnect();
      
      // 6. å–æœ€åä¸€ä¸ªæœ‰æ•ˆæ¡ç›®ä½œä¸ºæœ€ç»ˆ LCPï¼ˆæ ¹æ®è§„èŒƒï¼‰
      const finalEntry = lcpEntries[lcpEntries.length - 1];
      const lcp = finalEntry?.renderTime || maxLcpValue;
      
      console.log('LCP:', lcp);
      sendToAnalytics({ metric: 'LCP', value: lcp });
    }, 0);
  });

  // 7. ç”¨æˆ·äº¤äº’ååœæ­¢è®°å½•ï¼ˆè§„èŒƒè¦æ±‚ï¼‰
  ['click', 'keydown', 'scroll'].forEach(event => {
    window.addEventListener(event, () => observer.disconnect(), { once: true });
  });
};

getLCP();
```

3. **é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID - First Input Delay)**
    - ç”¨æˆ·**é¦–æ¬¡äº¤äº’**ï¼ˆç‚¹å‡»ã€è¾“å…¥ç­‰ï¼‰åˆ°æµè§ˆå™¨**å®é™…å“åº”**çš„æ—¶é—´å·®ã€‚
    - **ç›®æ ‡**ï¼š< 100 æ¯«ç§’ï¼ˆè‰¯å¥½ï¼‰
```js
const getFID = () => {
  // 1. è®°å½•é¦–æ¬¡äº¤äº’æ—¶é—´
  let firstInteractionTime = performance.now();
  let hasReported = false;

  // 2. ç›‘å¬é¦–æ¬¡è¾“å…¥äº‹ä»¶
  const listener = (event) => {
    // 3. è·³è¿‡éç”¨æˆ·ä¸»åŠ¨äº¤äº’ï¼ˆå¦‚æ»šåŠ¨ï¼‰
    if (event.cancelable) {
      const delay = event.processingStart - event.startTime;
      
      console.log('FID:', delay);
      sendToAnalytics({ metric: 'FID', value: delay });
      
      // 4. ç§»é™¤ç›‘å¬
      window.removeEventListener('mousedown', listener);
      window.removeEventListener('keydown', listener);
      hasReported = true;
    }
  };

  // 5. é€šè¿‡ PerformanceObserver æ•è· first-input æ¡ç›®
  const observer = new PerformanceObserver(list => {
    list.getEntries().forEach(entry => {
      if (entry.entryType === 'first-input' && !hasReported) {
        const delay = entry.processingStart - entry.startTime;
        console.log('FID (via Observer):', delay);
        sendToAnalytics({ metric: 'FID', value: delay });
        hasReported = true;
      }
    });
  });

  observer.observe({ type: 'first-input', buffered: true });
  
  // 6. é™çº§æ–¹æ¡ˆï¼šæ‰‹åŠ¨ç›‘å¬äº‹ä»¶
  window.addEventListener('mousedown', listener, { once: true, capture: true });
  window.addEventListener('keydown', listener, { once: true, capture: true });
};

getFID();****
```
4. **ç´¯ç§¯å¸ƒå±€åç§» (CLS - Cumulative Layout Shift)**
    - è¡¡é‡é¡µé¢æ¸²æŸ“æœŸé—´**è§†è§‰ç¨³å®šæ€§**ï¼ˆå…ƒç´ æ„å¤–åç§»çš„é¢‘ç‡å’Œå¹…åº¦ï¼‰ã€‚
    - **ç›®æ ‡**ï¼š< 0.1ï¼ˆè‰¯å¥½ï¼‰
```js
const getCLS = () => {
  let sessionValue = 0;
  let sessionEntries = [];
  let clsValue = 0;

  // 1. å¸ƒå±€åç§»ç›‘å¬å™¨
  const observer = new PerformanceObserver((list) => {
    list.getEntries().forEach(entry => {
      // 2. å¿½ç•¥ç”¨æˆ·æ“ä½œå500mså†…çš„åç§»ï¼ˆè§„èŒƒè¦æ±‚ï¼‰
      if (!entry.hadRecentInput) {
        const lastEntry = sessionEntries[sessionEntries.length - 1];
        
        // 3. æ£€æŸ¥æ˜¯å¦åŒä¸€ä¼šè¯ï¼ˆ1ç§’å†…è¿ç»­åç§»ï¼‰
        if (sessionEntries.length === 0 || 
            entry.startTime - lastEntry.startTime < 1000) {
          sessionValue += entry.value;
        } else {
          sessionValue = entry.value;
          sessionEntries = [];
        }
        
        // 4. è®°å½•å½“å‰æ¡ç›®
        sessionEntries.push(entry);
        
        // 5. æ›´æ–°æœ€å¤§ä¼šè¯å€¼
        if (sessionValue > clsValue) {
          clsValue = sessionValue;
        }
      }
    });
  });

  // 6. å¼€å§‹ç›‘å¬å¸ƒå±€åç§»
  observer.observe({ type: 'layout-shift', buffered: true });

  // 7. é¡µé¢éšè—æ—¶ä¸ŠæŠ¥æœ€ç»ˆCLS
  const reportCLS = () => {
    observer.disconnect();
    console.log('CLS:', clsValue);
    sendToAnalytics({ metric: 'CLS', value: clsValue });
  };

  // 8. åœ¨é¡µé¢å¸è½½æˆ–éšè—æ—¶æŠ¥å‘Š
  window.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'hidden') reportCLS();
  });
  window.addEventListener('pagehide', reportCLS);
};

getCLS();
```
5. **é¦–å­—èŠ‚æ—¶é—´ (TTFB - Time to First Byte)**
    - ä»å‘èµ·è¯·æ±‚åˆ°æ”¶åˆ°æœåŠ¡å™¨å“åº”çš„**ç¬¬ä¸€ä¸ªå­—èŠ‚**çš„æ—¶é—´ï¼Œåæ˜ æœåŠ¡å™¨å“åº”é€Ÿåº¦ã€‚

6. **é¡µé¢å®Œå…¨åŠ è½½æ—¶é—´ (Load Time)**
    - ä»å¯¼èˆªå¼€å§‹åˆ° `window.onload` äº‹ä»¶è§¦å‘çš„æ—¶é—´ã€‚

---

### äºŒã€ **é”™è¯¯ç›‘æ§ï¼ˆErrorsï¼‰**
1. **JavaScript è¿è¡Œæ—¶é”™è¯¯**
    - é€šè¿‡ `window.onerror` æˆ– `addEventListener('error')` æ•è·çš„æœªå¤„ç†å¼‚å¸¸ã€‚
2. **èµ„æºåŠ è½½å¤±è´¥**
    - å›¾ç‰‡ã€è„šæœ¬ã€CSS ç­‰åŠ è½½å¤±è´¥ï¼ˆé€šè¿‡ `addEventListener('error')` æ•è·ï¼‰ã€‚
3. **Promise æœªæ•è·å¼‚å¸¸**
    - é€šè¿‡ `unhandledrejection` äº‹ä»¶ç›‘æ§ã€‚
4. **æ¥å£è¯·æ±‚é”™è¯¯**
    - HTTP çŠ¶æ€ç ï¼ˆ4xx/5xxï¼‰ã€ç½‘ç»œè¶…æ—¶ç­‰ã€‚

---

### ä¸‰ã€ **ç”¨æˆ·è¡Œä¸ºä¸ä½“éªŒï¼ˆUXï¼‰**
1. **é¡µé¢æµè§ˆé‡ï¼ˆPVï¼‰ä¸ç‹¬ç«‹è®¿å®¢ï¼ˆUVï¼‰**
2. **ç”¨æˆ·äº¤äº’è·¯å¾„**
    - æŒ‰é’®ç‚¹å‡»ã€è¡¨å•æäº¤ã€è·¯ç”±è·³è½¬ç­‰å…³é”®æ“ä½œã€‚
3. **ç™½å±ç‡**
    - é¡µé¢å®Œå…¨æ— å†…å®¹æ¸²æŸ“çš„æ¯”ä¾‹ã€‚
4. **å¡é¡¿ç‡**
    - é¡µé¢å¸§ç‡ï¼ˆFPSï¼‰ä½äº 60 å¸§/ç§’çš„æŒç»­æ—¶é—´å æ¯”ã€‚

---

### å››ã€ **æ¥å£ç›‘æ§ï¼ˆAPIï¼‰**
1. **è¯·æ±‚æˆåŠŸç‡**
    - æˆåŠŸå“åº”ï¼ˆ2xx/3xxï¼‰çš„è¯·æ±‚æ¯”ä¾‹ã€‚
2. **è¯·æ±‚è€—æ—¶åˆ†å¸ƒ**
    - P50ã€P90ã€P99 åˆ†ä½çš„æ¥å£å“åº”æ—¶é—´ã€‚
3. **æ…¢è¯·æ±‚æ¯”ä¾‹**
    - è¶…è¿‡è®¾å®šé˜ˆå€¼ï¼ˆå¦‚ 2 ç§’ï¼‰çš„è¯·æ±‚å æ¯”ã€‚
4. **é”™è¯¯ç±»å‹åˆ†å¸ƒ**
    - 4xxï¼ˆå®¢æˆ·ç«¯é”™è¯¯ï¼‰ vs 5xxï¼ˆæœåŠ¡ç«¯é”™è¯¯ï¼‰ã€‚

---

### äº”ã€ **èµ„æºæ€§èƒ½ï¼ˆAssetsï¼‰**
1. **CDN èµ„æºåŠ è½½é€Ÿåº¦**
    - JSã€CSSã€å›¾ç‰‡ç­‰é™æ€èµ„æºçš„åŠ è½½è€—æ—¶ã€‚
2. **èµ„æºç¼“å­˜å‘½ä¸­ç‡**
    - åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ï¼ˆ`memory-cache`/`disk-cache`ï¼‰çš„æ¯”ä¾‹ã€‚

---

### å…­ã€ **ä¸šåŠ¡è‡ªå®šä¹‰æŒ‡æ ‡**
1. **å…³é”®æµç¨‹è½¬åŒ–ç‡**
    - å¦‚æ³¨å†Œã€æ”¯ä»˜æµç¨‹çš„å®Œæˆç‡ã€‚
2. **åŠŸèƒ½ä½¿ç”¨ç‡**
    - ç‰¹å®šåŠŸèƒ½æ¨¡å—çš„ç‚¹å‡»/ä½¿ç”¨é¢‘ç‡ã€‚
3. **ç”¨æˆ·åœç•™æ—¶é•¿**
    - é¡µé¢æˆ–åº”ç”¨çš„å•æ¬¡ä½¿ç”¨æ—¶é•¿ã€‚

---

### ç›‘æ§å·¥å…·ç¤ºä¾‹
- **å¼€æºæ–¹æ¡ˆ**ï¼šSentryï¼ˆé”™è¯¯ç›‘æ§ï¼‰ã€Prometheus + Grafanaï¼ˆæ€§èƒ½æŒ‡æ ‡ï¼‰ã€Elastic APM
- **å•†ä¸šå¹³å°**ï¼šDatadogã€New Relicã€é˜¿é‡Œäº‘ ARMSã€è…¾è®¯äº‘å‰ç«¯æ€§èƒ½ç›‘æ§
- **æ ‡å‡†åè®®**ï¼šä½¿ç”¨ [W3C Performance Timeline API](https://w3c.github.io/performance-timeline/) é‡‡é›†æ€§èƒ½æ•°æ®

---

### å…³é”®å®è·µå»ºè®®
1. **æ ¸å¿ƒ Web æŒ‡æ ‡ï¼ˆWeb Vitalsï¼‰ä¼˜å…ˆ**ï¼šèšç„¦ LCPã€FIDã€CLS ä¸‰å¤§ç”¨æˆ·ä½“éªŒæŒ‡æ ‡ã€‚
2. **é”™è¯¯èšåˆä¸å‘Šè­¦**ï¼šå¯¹é«˜é¢‘é”™è¯¯å®æ—¶å‘Šè­¦ï¼Œé¿å…å½±å“èŒƒå›´æ‰©å¤§ã€‚
3. **ç”¨æˆ·ä¼šè¯è¿½è¸ªï¼ˆSession Replayï¼‰**ï¼šå¤ç°ç”¨æˆ·æ“ä½œè·¯å¾„ï¼Œè¾…åŠ©å®šä½é—®é¢˜ã€‚
4. **æ€§èƒ½é‡‡æ ·ä¸èšåˆ**ï¼šå…¨é‡ç›‘æ§å¯èƒ½æ¶ˆè€—æ€§èƒ½ï¼Œåˆç†é‡‡æ ·é™ä½å¼€é”€ã€‚

> ğŸ’¡ ç›‘æ§çš„æ ¸å¿ƒç›®æ ‡æ˜¯ **å¿«é€Ÿå‘ç°é—®é¢˜ â†’ å®šä½æ ¹å›  â†’ é©±åŠ¨ä¼˜åŒ–**ã€‚å»ºè®®ç»“åˆä¸šåŠ¡åœºæ™¯é€‰æ‹©å…³é”®æŒ‡æ ‡ï¼Œé¿å…è¿‡åº¦ç›‘æ§ã€‚